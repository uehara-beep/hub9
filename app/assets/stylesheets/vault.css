:root{
  --hermes:#ff7a00;
  --bg:#f6f3ef;
  --card:#fff;
  --txt:#1a1a1a;
  --sub:#666;
  --danger:#d9534f;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;font-family:-apple-system,BlinkMacSystemFont,"Hiragino Sans",sans-serif}

/* ========== Common Layout ========== */
.vault-body{
  background:var(--bg);
  min-height:100vh;
  padding-bottom:env(safe-area-inset-bottom);
}
.vault-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px 16px;
  background:var(--hermes);
  color:#fff;
}
.vault-title{font-size:18px;font-weight:700}
.vault-actions{display:flex;gap:8px}
.vault-main{padding:16px}

/* ========== Horse Button ========== */
.horse-btn{
  width:44px;height:44px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:14px;
  background:rgba(255,255,255,.25);
  font-size:20px;
  text-decoration:none;
  color:#fff;
  user-select:none;
  touch-action:manipulation;
  border:none;
}

/* ========== Card ========== */
.vault-card{
  background:var(--card);
  border-radius:18px;
  box-shadow:0 10px 28px rgba(0,0,0,.08);
  padding:16px;
  margin-bottom:16px;
}
.vault-card-h{
  font-size:13px;
  font-weight:600;
  color:var(--sub);
  margin-bottom:12px;
  text-transform:uppercase;
  letter-spacing:0.5px;
}

/* ========== PIN Screen ========== */
.vault-screen{
  min-height:100vh;
  padding:24px;
  background:var(--bg);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}
.pin-dots{
  display:flex;
  justify-content:center;
  gap:12px;
  margin:24px 0;
}
.pin-dots span{
  width:14px;height:14px;
  border-radius:50%;
  background:#ddd;
  transition:background .15s;
}
.pin-dots span.filled{background:var(--hermes)}
.pin-pad{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
  max-width:260px;
  margin:0 auto;
}
.pin-pad button{
  width:64px;height:64px;
  border-radius:50%;
  border:none;
  background:var(--card);
  box-shadow:0 4px 12px rgba(0,0,0,.1);
  font-size:24px;
  font-weight:500;
  color:var(--txt);
  cursor:pointer;
  touch-action:manipulation;
}
.pin-pad button:active{background:#f0ebe5}

/* ========== Home Cards ========== */
.vault-sub{opacity:.7;margin-top:8px;font-size:14px}
.vault-cards{display:grid;gap:14px;margin-top:18px}

/* ========== Entry List ========== */
.vault-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 0;
  border-bottom:1px solid #eee;
  text-decoration:none;
  color:var(--txt);
}
.vault-row:last-child{border-bottom:none}
.row-left{flex:1;min-width:0}
.row-date{font-size:12px;color:var(--sub)}
.row-tag{font-size:15px;font-weight:600;margin-top:2px}
.row-memo{font-size:13px;color:var(--sub);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.row-right{text-align:right;padding-left:12px}
.row-kind{
  display:inline-block;
  padding:2px 8px;
  border-radius:8px;
  font-size:11px;
  font-weight:600;
}
.row-kind.expense{background:#ffe5e5;color:#c0392b}
.row-kind.income{background:#e5f7e5;color:#27ae60}
.row-amt{font-size:16px;font-weight:700;margin-top:4px}

.vault-empty{
  text-align:center;
  padding:32px 0;
  color:var(--sub);
  font-size:14px;
}
.vault-toast{
  background:var(--hermes);
  color:#fff;
  text-align:center;
  padding:10px 16px;
  font-size:14px;
}

/* ========== Form ========== */
.field{margin-bottom:18px}
.field label{
  display:block;
  font-size:13px;
  font-weight:600;
  color:var(--sub);
  margin-bottom:6px;
}
.field input[type="text"],
.field input[type="number"],
.field input[type="date"],
.field select,
.field textarea{
  width:100%;
  padding:12px 14px;
  border:1px solid #ddd;
  border-radius:12px;
  font-size:16px;
  background:#fff;
  -webkit-appearance:none;
}
.field textarea{resize:vertical}
.field input[type="file"]{
  padding:10px 0;
  border:none;
  font-size:14px;
}
.hint{font-size:12px;color:var(--sub);margin-top:4px}

.vault-primary{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:var(--hermes);
  color:#fff;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  touch-action:manipulation;
}
.vault-primary:active{opacity:.85}

.vault-error{
  background:#ffe5e5;
  border-radius:12px;
  padding:12px 14px;
  margin-bottom:16px;
  font-size:14px;
  color:#c0392b;
}

/* ========== Detail View ========== */
.detail-row{
  display:flex;
  padding:10px 0;
  border-bottom:1px solid #eee;
}
.detail-row:last-child{border-bottom:none}
.detail-label{
  width:80px;
  flex-shrink:0;
  font-size:13px;
  color:var(--sub);
}
.detail-value{
  flex:1;
  font-size:15px;
}
.detail-amt{font-size:20px;font-weight:700;color:var(--hermes)}
.detail-memo{white-space:pre-wrap}
.receipt-img{
  max-width:100%;
  border-radius:12px;
  margin-top:8px;
}

/* ========== Danger Zone ========== */
.danger-zone{border:1px solid var(--danger)}
.vault-danger{
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  background:var(--danger);
  color:#fff;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}
.vault-danger:active{opacity:.85}

/* ========== PIN Screen (New) ========== */
.vault-wrap{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}
.vault-card--wide{
  width:100%;
  max-width:360px;
}
.vault-pin-form{margin-top:16px}
.vault-pin-input{
  width:100%;
  padding:14px;
  border:1px solid #ddd;
  border-radius:14px;
  font-size:24px;
  font-weight:700;
  text-align:center;
  letter-spacing:8px;
  background:#fff;
  -webkit-appearance:none;
}
.vault-pin-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
  margin-top:14px;
}
.vault-pin-key{
  position:relative;
  z-index:50;
  pointer-events:auto;
  -webkit-tap-highlight-color:transparent;
  height:54px;
  border-radius:16px;
  border:1px solid rgba(0,0,0,.08);
  background:rgba(255,255,255,.78);
  font-size:20px;
  font-weight:700;
  cursor:pointer;
  touch-action:manipulation;
}
.vault-pin-key:active{background:#f0ebe5}
.vault-pin-key--ghost{
  background:transparent;
  border-color:transparent;
  color:var(--danger);
}
.vault-pin-key--ok{
  background:var(--hermes);
  color:#fff;
  border-color:var(--hermes);
}
.vault-alert{
  margin-top:14px;
  padding:10px 14px;
  background:#ffe5e5;
  border-radius:10px;
  color:#c0392b;
  font-size:14px;
  text-align:center;
}

/* ========== Money Quick Entry ========== */
.money-form{margin-top:16px}
.money-cats{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-bottom:18px;
}
.money-cat{
  flex:1;
  min-width:70px;
  padding:10px 6px;
  border:1px solid #ddd;
  border-radius:12px;
  background:#fff;
  font-size:13px;
  font-weight:600;
  cursor:pointer;
  touch-action:manipulation;
  transition:all .15s;
}
.money-cat.is-active{
  background:var(--hermes);
  color:#fff;
  border-color:var(--hermes);
}
.money-cat--dark{
  background:#333;
  color:#fff;
  border-color:#333;
}
.money-cat--dark.is-active{
  background:#000;
  border-color:#000;
}
.money-row{margin-bottom:16px}
.money-label{
  display:block;
  font-size:13px;
  font-weight:600;
  color:var(--sub);
  margin-bottom:6px;
}
.money-amount{
  display:flex;
  align-items:center;
  gap:8px;
}
.money-input{
  flex:1;
  padding:12px 14px;
  border:1px solid #ddd;
  border-radius:12px;
  font-size:16px;
  background:#fff;
  -webkit-appearance:none;
}
.money-suffix{
  font-size:16px;
  font-weight:600;
  color:var(--txt);
}
.money-textarea{
  width:100%;
  padding:12px 14px;
  border:1px solid #ddd;
  border-radius:12px;
  font-size:16px;
  background:#fff;
  resize:vertical;
  -webkit-appearance:none;
}
.money-file{
  padding:10px 0;
  border:none;
  font-size:14px;
}
.money-hint{
  font-size:12px;
  color:var(--sub);
  margin-top:4px;
}
.money-submit{margin-top:8px}
.money-danger{
  margin-top:16px;
  text-align:center;
}
.money-back{
  color:var(--sub);
  font-size:14px;
  text-decoration:none;
}
.money-back:hover{text-decoration:underline}

/* ========== iPhone Button Fix ========== */
body::before,
body::after,
.vault-bg::before,
.vault-bg::after,
.page-bg::before,
.page-bg::after,
.overlay,
.backdrop,
.glow-layer {
  pointer-events: none !important;
}

.vault-page, .vault-wrap, .vault-container {
  position: relative;
  z-index: 1;
}

.vault-card,
.vault-card a,
.vault-card button,
.vault-actions a,
.vault-actions button {
  position: relative;
  z-index: 5;
  pointer-events: auto !important;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

/* ========== Vault Home Hero ========== */
.vault-hero{
  text-align:center;
  padding:32px 16px 24px;
}
.vault-hero h1{
  font-size:28px;
  margin:0;
}
.vault-hero p{
  margin-top:8px;
  font-size:14px;
  color:var(--sub);
}
.vault-page{
  min-height:100vh;
  background:var(--bg);
  padding-bottom:env(safe-area-inset-bottom);
}
.vault-page .vault-actions{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  padding:0 16px;
}
.vault-page .vault-card{
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:100px;
  font-size:15px;
  font-weight:600;
  text-decoration:none;
  color:var(--txt);
}

/* ========== Transfer UI ========== */
.vault-form{
  max-width:520px;
  margin:0 auto;
  display:grid;
  gap:14px;
  padding:0 16px 32px;
}
.seg{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.seg-item{
  display:block;
  cursor:pointer;
  user-select:none;
}
.seg-item input{display:none}
.seg-item span{
  display:flex;
  justify-content:center;
  align-items:center;
  padding:14px 10px;
  border-radius:16px;
  border:1px solid rgba(0,0,0,.08);
  background:rgba(255,255,255,.75);
  font-weight:700;
  transition:all .15s;
}
.seg-item input:checked + span{
  border-color:var(--hermes);
  background:var(--hermes);
  color:#fff;
  box-shadow:0 8px 20px rgba(0,0,0,.08);
}
