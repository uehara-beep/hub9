<div style="min-height: 100vh; background: #f6f1ea;">
  <!-- „Éò„ÉÉ„ÉÄ„ÉºÔºàÂõ∫ÂÆöÔºâ -->
  <div class="hub-header" style="background: #ff7a00; color: white; border-bottom: none;">
    <div class="hub-header-content">
      <div style="display: flex; align-items: center; gap: 12px;">
        <%= link_to "‚Üê", root_path, style: "color: white; font-size: 24px; text-decoration: none; font-weight: 700;" %>
        <div>
          <h1 style="color: white; margin: 0;">ü§µ ÁßòÊõ∏</h1>
          <p style="font-size: 11px; color: rgba(255,255,255,.8); margin: 4px 0 0;">mode A</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ‰ºöË©±„Ç®„É™„Ç¢Ôºà„Çπ„ÇØ„É≠„Éº„É´ÂèØËÉΩÔºâ -->
  <div class="hub-content" id="chat-messages">
    <% if @messages.blank? %>
      <div style="text-align: center; padding: 60px 20px; color: #6b7280;">
        <p style="font-size: 14px;">„Åæ„Å†„É°„ÉÉ„Çª„Éº„Ç∏„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
        <p style="font-size: 12px; margin-top: 8px;">‰Ωï„Åß„ÇÇË©±„Åó„Åã„Åë„Å¶„Åè„Å†„Åï„ÅÑ</p>
      </div>
    <% else %>
      <div class="chat-container">
        <!-- Êñ∞„Åó„ÅÑÈ†Ü„Å´Ë°®Á§∫Ôºàdesc„Åß„ÇΩ„Éº„ÉàÊ∏à„Åø„Å™„ÅÆ„Åß.reverse„ÅØ‰∏çË¶ÅÔºâ -->
        <% @messages.each do |message| %>
          <div class="chat-message <%= message.role == 'user' ? 'chat-message-user' : '' %>">
            <!-- „Ç¢„Éê„Çø„Éº -->
            <div class="chat-avatar <%= message.role == 'assistant' ? 'chat-avatar-assistant' : '' %>">
              <%= message.role == 'user' ? 'ta9' : 'ÁßòÊõ∏' %>
            </div>
            
            <!-- „É°„ÉÉ„Çª„Éº„Ç∏ÂÜÖÂÆπ -->
            <div class="chat-message-content">
              <!-- ÈÄÅ‰ø°ËÄÖÂêç -->
              <div class="chat-sender-name">
                <%= message.role == 'user' ? 'ta9' : 'ÁßòÊõ∏' %>
              </div>
              
              <!-- Âêπ„ÅçÂá∫„Åó -->
              <div class="chat-bubble <%= message.role == 'user' ? 'chat-bubble-user' : 'chat-bubble-assistant' %>">
                <%= simple_format(message.content) %>
                
                <!-- ÁîªÂÉè„Åå„ÅÇ„ÇãÂ†¥Âêà -->
                <% if message.image_url.present? %>
                  <img src="<%= message.image_url %>" class="chat-image" alt="Ê∑ª‰ªòÁîªÂÉè">
                <% end %>
              </div>
              
              <!-- ÊôÇÂàª -->
              <div class="chat-time">
                <%= message.created_at.strftime('%H:%M') %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <!-- ÂÖ•Âäõ„Ç®„É™„Ç¢ÔºàÂõ∫ÂÆöÔºâ -->
  <div class="hub-footer-fixed">
    <div class="hub-footer-content">
      <%= form_with url: hub_send_message_path, 
                    method: :post,
                    multipart: true,
                    data: { 
                      controller: "line-chat",
                      action: "submit->line-chat#send"
                    } do |f| %>
        
        <!-- ÁîªÂÉè„Éó„É¨„Éì„É•„Éº -->
        <div data-line-chat-target="previewContainer" style="display: none;" class="image-preview-container">
          <img data-line-chat-target="preview" class="image-preview" />
          <button type="button" 
                  class="image-preview-remove"
                  data-action="click->line-chat#removeImage">
            ÂâäÈô§
          </button>
        </div>

        <!-- ÂÖ•Âäõ„ÉÑ„Éº„É´„Éê„Éº -->
        <div class="input-toolbar">
          <!-- Ôºã„Éú„Çø„É≥ÔºàÁîªÂÉèÊ∑ª‰ªòÔºâ -->
          <label class="input-attach-btn">
            Ôºã
            <%= f.file_field :image,
                             accept: "image/*",
                             capture: "environment",
                             style: "display: none;",
                             data: { 
                               action: "change->line-chat#previewImage",
                               "line-chat-target": "fileInput"
                             } %>
          </label>

          <!-- ÂÖ•ÂäõÊ¨ÑÔºãÈÄÅ‰ø°„Éú„Çø„É≥ -->
          <div class="input-field-wrapper">
            <%= f.text_area :message, 
                            rows: 1,
                            placeholder: "„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂÖ•Âäõ...",
                            data: { 
                              "line-chat-target": "input",
                              action: "keydown->line-chat#handleKeydown input->line-chat#autoResize"
                            } %>

            <button type="submit" 
                    class="input-send-btn"
                    data-line-chat-target="submit">
              ‚ñ∂
            </button>
          </div>
        </div>

        <!-- „É¢„Éá„É´ÈÅ∏ÊäûÔºàÂ∞è„Åï„ÅèÔºâ -->
        <div style="margin-top: 8px; text-align: center;">
          <%= f.select :model, 
                       [["Sonnet 4.5", "claude-sonnet-4.5"], ["GPT-4o", "gpt-4o"]],
                       {},
                       style: "padding: 4px 8px; border-radius: 6px; border: 1px solid rgba(0,0,0,.15); font-size: 11px; background: white; color: #6b7280;" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
