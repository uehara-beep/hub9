<% content_for :head do %>
  <%= stylesheet_link_tag "hub", "data-turbo-track": "reload" %>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700;800&family=Sora:wght@600;700;800&display=swap" rel="stylesheet">
<% end %>

<div class="home">
  <!-- Animated Blob -->
  <div class="home-blob"></div>

  <!-- Header -->
  <header class="hm-hdr">
    <div class="hm-logo">H9</div>
    <div class="hm-av">ta9</div>
  </header>

  <!-- Greeting -->
  <div class="hm-greet">
    <strong><%= Time.current.hour < 12 ? "Good morning" : Time.current.hour < 18 ? "Good afternoon" : "Good evening" %></strong>, ta9
  </div>

  <!-- Menu Grid -->
  <nav class="hm-grid">
    <!-- Mia (Secretary) -->
    <a class="mc" href="<%= hub_secretary_path %>">
      <div class="mc-ico mc-ico-mia">Mia</div>
      <div class="mc-nm">Mia</div>
      <div class="mc-sub">AI Secretary</div>
    </a>

    <!-- Charge -->
    <a class="mc" href="<%= charge_entries_path %>">
      <div class="mc-ico mc-ico-charge">$</div>
      <div class="mc-nm">Charge</div>
      <div class="mc-sub">Expense Tracking</div>
    </a>

    <!-- Coming Soon slots -->
    <a class="mc" href="#">
      <div class="mc-ico mc-ico-coming">?</div>
      <div class="mc-nm">Coming Soon</div>
      <div class="mc-sub">New feature</div>
    </a>

    <a class="mc" href="#">
      <div class="mc-ico mc-ico-coming">?</div>
      <div class="mc-nm">Coming Soon</div>
      <div class="mc-sub">New feature</div>
    </a>
  </nav>

  <!-- Today's Card -->
  <div class="td-card">
    <div class="td-hdr">
      <span class="td-t">Today's Charge</span>
      <span class="td-date"><%= Date.current.strftime('%m/%d') %></span>
    </div>
    <% if @today_entries.blank? %>
      <div class="td-empty">No records yet</div>
    <% else %>
      <div class="td-list">
        <% @today_entries.each do |e| %>
          <div class="td-item">
            <span class="td-item-info"><%= e.counterparty.presence || e.category.presence || "—" %></span>
            <span class="td-item-amount <%= e.direction_outgoing? ? 'neg' : 'pos' %>">
              <%= e.direction_outgoing? ? "−" : "+" %> ¥<%= number_with_delimiter(e.amount_yen.to_i) %>
            </span>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
